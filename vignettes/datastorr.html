<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Rich FitzJohn" />

<meta name="date" content="2015-12-13" />

<title>datastorr</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0A%7D%0Apre%20%7B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">datastorr</h1>
<h4 class="author"><em>Rich FitzJohn</em></h4>
<h4 class="date"><em>2015-12-13</em></h4>
</div>


<div id="scope" class="section level2">
<h2>Scope</h2>
<p>This package attempts to simultaneously solve a number of problems around small-scale data versioning and distribution:</p>
<ul>
<li><p>Giving users access to your data in an easily machine-digestable format.</p></li>
<li><p>Hosting and distributing the data somewhere fast and reliable without having to deal with creating websites.</p></li>
<li><p>Protecting access to the data to collaborators, especially with the idea of later public release.</p></li>
<li><p>Allowing a dataset to be downloaded once and reused for multiple projects on a single computer, without having to deal with pathnames within or between systems.</p></li>
<li>Versioning the data so that:
<ul>
<li>fetching the current version is easy,</li>
<li>fetching a previous version is easy,</li>
<li>simultaneously looking at two versions is easy,</li>
<li>data versions are strongly associated with the code that created them,</li>
<li>end users do not have to use git,</li>
<li>large files do not end up clogging up your git repository.</li>
</ul></li>
<li><p>Allows publication of data packages on CRAN without causing problems of large package file downloads.</p></li>
<li><p>Provides a common interface for storing and retrieving data that works across diverse underlying data formats (one or many csv files, binary data, phylogenic trees, or a collection of all of these), so long as you have a way of reading the data into R.</p></li>
</ul>
<p>The package is designed so that you can do all of that in 22 lines of code (which you can generate with one function call).</p>
<p>Data comes in all shapes and sizes, and a one-size fits all solution will not fit everything.</p>
<ul>
<li><p>Too small: One-off data sets (e.g. a field experient that will not be updated). Put the data on data dryad, figshare, or wherever you fancy. Stick a fork in it, it’s done (though you can use this package you’ll likely find it easier not to).</p></li>
<li><p>Too big: Massively collaborative datasets with large end users communities, data sets that are so large they require access via APIs, data with access control requiring complex authentication layers, data with complex metadata where access is related to metadata. There are more comprehensive solutions for your data but identifying the correct solution may depend on the data.</p></li>
<li><p>Just right: A data set of medium size (say, under 100 MB), that is under moderate levels of change (either stabilising or a “living database” that is continually being updated).</p></li>
</ul>
</div>
<div id="how-it-works" class="section level2">
<h2>How it works</h2>
<p>We create an extremely small R package in a git repository, and publish that git repository to GitHub. The git repository contains only a bit of metadata that uses <code>datastorr</code> to download and retrieve your data (see below). It can however contain whatever code you would like for working with your data set. In our own use, the repository (but not the package) contains code for <em>building</em> the data set (see <a href="https://github.com/traitecoevo/taxonlookup">taxonlookup</a>).</p>
<p>GitHub has a “releases” feature for allowing (potentially large) file uploads. These files can be any format. GitHub releases are build off of git “tags”; they are <em>associated with a specific version</em>. So if you have code that creates or processes a dataset, the dataset will be stored against the code used to create it, which is nice. GitHub releases <em>do not store the file in the repository</em>. This avoids issues with git slowing down on large files, on lengthy clone times, and on distributing and installing your package. This could be an issue if you had 100 versions of a 10 MB dataset; that could be 1GB of data to clone or install. But storing your data against GitHub releases will leave the data in the cloud until it is needed.</p>
<p>The releases will be numbered. We recommend <a href="http://semver.org">semantic versioning</a> mostly because it signals some intent about changes to the data (see below).</p>
<p>We will make the simplifying assumption that your data set will be stored in a single file. In practice this is not a limitation because that file could be a zip archive. The file can be in any format; csv, rds (R’s internal format), a SQLite database. You, however, need to provide a function that will read the data and convert it into an R object. So for a csv file you’d provide a function that would be <code>read.csv</code> perhaps with a few arguments set (e.g., <code>stringsAsFactors=FALSE</code>). For an rds file you could just use <code>readRDS</code>. And for a zip file you would need a more complicated function (see the worked example).</p>
<p>Once your git repsitory is published and your data have been released, downloading it becomes a function within your package. A user would run something like:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d &lt;-<span class="st"> </span>mypackage::<span class="kw">mydata</span>()</code></pre></div>
<p>to fetch or load the data. This function is designed to be <em>fast</em>. It uses <a href="https://github.com/richfitz/storr"><code>storr</code></a> behind the scenes and looks in various places for the data:</p>
<ol style="list-style-type: decimal">
<li><p>In memory; if it has been loaded within this session it is already in memory. Takes on the order of microseconds.</p></li>
<li><p>From disk; if the data has <em>ever</em> been loaded datastorr will cache a copy on disk. Takes on the order of milliseconds up to a second, depending on the size of the data.</p></li>
<li><p>From GitHub; if the data has never been loaded, it will be downloaded from GitHub, saved to disk, and loaded to memory. This will take several seconds or longer depending on the size of the dataset.</p></li>
</ol>
<p>In addition, users can download specific versions of a dataset. This might be to synchronise data versions across different people in a project, to lock a project onto a specific version, etc:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d &lt;-<span class="st"> </span>mypackage::<span class="kw">mydata</span>(<span class="st">&quot;v1.0.0&quot;</span>)</code></pre></div>
<p>The same cascading lookup as above works.</p>
<p>This approach extends to holding multiple versions of the data on a single computer (or in a single R session). This might be useful when the dataset has changed and you want to see what has changed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d1 &lt;-<span class="st"> </span>mypackage::<span class="kw">mydata</span>(<span class="st">&quot;v1.0.0&quot;</span>)
d2 &lt;-<span class="st"> </span>mypackage::<span class="kw">mydata</span>(<span class="st">&quot;v1.1.0&quot;</span>)
## ...compare d1 and d2 here...</code></pre></div>
</div>
<div id="worked-example" class="section level2">
<h2>Worked example</h2>
<p>First, you will need a package. Creating packages is not that hard, especialy with tools like <a href="https://github.com/hadley/devtools">devtools</a> and <a href="https://github.com/gaborcsardi/mason">mason</a>. Packages make running R code on other machines much simpler than sourcing in files or copy and paste. Packages are also nice because if your data require specific package to work with (e.g., <code>ape</code> for phylogenetic trees) you can declare them in your <code>DESCRIPTION</code> file and R will ensure that they are installed when your package is installed and loaded when your package is used.</p>
<p>However, you will need to come up with a few details:</p>
<ul>
<li>a package name</li>
<li>a name for the dataset (if different to the package name)</li>
<li>a <em>licence</em> for your package (code) and data (not code)</li>
<li>ideally, documentation for your end users</li>
<li>the name of the file that you will store with each release</li>
</ul>
<p>In addition you need to set up a GitHub token so that you can upload files to GitHub from R, or to access your private repositories; see the section on authentication below, or just do nothing as datastorr will prompt you at the appropriate time.</p>
<p>The core code can be autogenerated. For example the package <a href="https://github.com/richfitz/datastorr.example">datastorr.example</a> was generated using</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datastorr::<span class="kw">autogenerate</span>(<span class="st">&quot;richfitz/datastorr.example&quot;</span>, <span class="st">&quot;readRDS&quot;</span>,
                        <span class="dt">name=</span><span class="st">&quot;mydata&quot;</span>, <span class="dt">roxygen=</span><span class="ot">FALSE</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mydata &lt;-<span class="st"> </span>function(<span class="dt">version=</span><span class="ot">NULL</span>, <span class="dt">path=</span><span class="ot">NULL</span>) {
  datastorr::<span class="kw">github_release_get</span>(<span class="kw">mydata_info</span>(path), version)
}

mydata_versions &lt;-<span class="st"> </span>function(<span class="dt">local=</span><span class="ot">TRUE</span>, <span class="dt">path=</span><span class="ot">NULL</span>) {
  datastorr::<span class="kw">github_release_versions</span>(<span class="kw">mydata_info</span>(path), local)
}

mydata_version_current &lt;-<span class="st"> </span>function(<span class="dt">local=</span><span class="ot">TRUE</span>, <span class="dt">path=</span><span class="ot">NULL</span>) {
  datastorr::<span class="kw">github_release_version_current</span>(<span class="kw">mydata_info</span>(path), local)
}

mydata_del &lt;-<span class="st"> </span>function(version, <span class="dt">path=</span><span class="ot">NULL</span>) {
  datastorr::<span class="kw">github_release_del</span>(<span class="kw">mydata_info</span>(path), version)
}

## Core data:
mydata_info &lt;-<span class="st"> </span>function(path) {
  datastorr::<span class="kw">github_release_info</span>(<span class="st">&quot;richfitz/datastorr.example&quot;</span>,
                                 <span class="dt">filename=</span><span class="ot">NULL</span>,
                                 <span class="dt">read=</span>readRDS,
                                 <span class="dt">path=</span>path)
}

mydata_release &lt;-<span class="st"> </span>function(..., <span class="dt">path=</span><span class="ot">NULL</span>) {
  datastorr::<span class="kw">github_release_create</span>(<span class="kw">mydata_info</span>(path), ...)
}</code></pre></div>
<p>This code can be copied into a file within the package. If you set <code>roxygen=TRUE</code> you’ll get roxygen help that <code>devtools::document()</code> will convert into R help files and <code>NAMESPACE</code> declarations.</p>
<p>The package can then be loaded and data accessed with the <code>mydata</code> function.</p>
<p>To make the release:</p>
<ol style="list-style-type: decimal">
<li><p>Increase the version number in your <code>DESCRIPTION</code> file</p></li>
<li><p>Your local repo is all committed (no unstaged files etc). This is important if you want to closely associate the release and your data and at the moment datastorr enforces it.</p></li>
<li><p>Push your changes to GitHub and install your package</p></li>
<li><p>Run <code>yourpackage::yourdata_release(&quot;A description here&quot;)</code></p></li>
<li><p>Check that it all worked by running <code>yourpackage::yourdata(&quot;new version&quot;)</code></p></li>
</ol>
<p>(you can get your new version by <code>read.dcf(&quot;DESCRIPTION&quot;)[, &quot;Version&quot;]</code>).</p>
</div>
<div id="access-control" class="section level2">
<h2>Access control</h2>
<p>Because GitHub offers private repositories, this gives some primitive, but potentailly useful, access control. Because datastorr uses GitHub’s authentication, GitHub knows if the user has access to private repositories. Therefore for this to work you will need to authenticate datastorr to work with GitHub.</p>
<p>The simplest way to do this is to let datastorr prompt you when access is required. Or run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datastorr::<span class="kw">datastorr_auth</span>()</code></pre></div>
<p>to force the authentication process to run (no error and no output indicates success). To force using personal access tokens rather than OAuth, run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">setup_github_token</span>()</code></pre></div>
<p>which will walk you through the steps of setting a token up.</p>
<p>If you use a personal private repository, then you invite other users to “collaborate” on the repository. Note that this gives the users push access to the repository; the access control is very coarse.</p>
<p>If you have an organisation account you can create groups of users that have read only access to particular repositories, which will likely scale better.</p>
</div>
<div id="semantic-versioning-of-data" class="section level2">
<h2>Semantic versioning of data</h2>
<p>Some will argue that it is not possible and they are probably right. But you need to go with some versioning system. If the idea of semantically versioning data bothers you, use incrementing integers (<code>v1</code>, <code>v2</code>, <code>v&lt;n&gt;</code>) and read no further!</p>
<p>The idea with semantic versioning is that it formalises what people do already with versioning. We feel this can be applied fairly successfully to data.</p>
<ul>
<li><strong>Update patch release</strong>; small changes, backward compatible.
<ul>
<li>adding new rows to the data set (more data)</li>
<li>error correcting existing data</li>
</ul></li>
<li><strong>Update minor version</strong>; medium changes, but generally backward compatible.
<ul>
<li>new columns</li>
<li>substantial new data</li>
<li>new tables</li>
</ul></li>
<li><strong>Update major version</strong>; large (API) changes, likely to be backward incompatible.
<ul>
<li>renaming or deleting columns</li>
<li>changing variable coding</li>
<li>deleting large amounts of data</li>
</ul></li>
</ul>
<p>Forks make this a lot more complicated. If two people are working in parallel how do they decide what version number to use? However, with our solution, the datasets are still sensibly named; we have:</p>
<ul>
<li><code>user1/dataset@v1.2.3</code></li>
<li><code>user2/dataset@v1.3.5</code></li>
</ul>
<p>It’s just not possible to know from the outside exactly what differs between the datasets but they are at least distinctly named (and you could download both of them). When the fork is resolved and <code>user2</code> merges back into <code>user1</code> the two researchers can discuss what version number they would want to use. Like resolving merge conflicts, we see this as a <em>social</em> problem, not a <em>technological</em> one and the soltuion will be social.</p>
</div>
<div id="beyond-github" class="section level2">
<h2>Beyond GitHub</h2>
<p>Apart from the ease of use, mindshare and the explicit association between data and code, there is no strong reason to use GitHub here. Certainly Bitbucket provides all the same functionality that is required to generalise our approach to work there. And self hosting would work too, with more effort. Over time we may develop support for alternative storage providers.</p>
<p>At the same time, the fast and generally reliable webserver, the access controls and the nice API make it a great first place to try this proof of concept.</p>
</div>
<div id="how-it-actually-works" class="section level2">
<h2>How it <em>actually</em> works</h2>
<p>GitHub has an API that lets you programmatically query the state of basically everything on GitHub, as well <em>create</em> things. So the interaction with the website is straightforward; getting lists of releases for a repository, filenames associated with releases, etc.</p>
<p>With this information, <code>datastorr</code> uses a <a href="https://richfitz.github.io/storr/vignettes/external.html"><code>storr_external</code></a> object and stores data with versions as keys. If a version is not found it is downloaded (using the information from GitHub) and read into R using the <code>read</code> function. A copy of this R-readable verison is saved to disk.</p>
<p>In order to save and load data repeatedly, especially across different projects on the same computer, <code>datastorr</code> uses the <code>rappdirs</code> package to find the “Right Place” to store “application data”. This varies by system and is documented in the <code>?rappdirs::user_data_dir</code> help page. Using this directory means there is little chance of accidently commiting large data sets into the repository (which might be a problem if storing the data in a subdirectory of the project).</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
